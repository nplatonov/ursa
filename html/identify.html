<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Get value and coordinates from location</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="file:///C:/Software/R/doc/html/R.css" />
</head><body>

<table width="100%" summary="page for identify"><tr><td>identify</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Get value and coordinates from location
</h2>

<h3>Description</h3>

<p>Functions to extract values of raster image from given location, specified by coordinates in raster projection, by cell position or by geogpaphical coordinates. Additional utils to convert cell position and planar coordinates mutually.
</p>


<h3>Usage</h3>

<pre>
value.xy(obj, ...)

value.ll(obj, ...)

value.cr(obj, ...)

coord.xy(obj, ...)

coord.cr(obj, ...)

</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>obj</code></td>
<td>

<p>Object of class <code>rmapRaster</code>.
</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>the set of argumetns, which are recognized via their names (using <a href="../../base/html/regex.html">regular expressions</a>) and classes:
</p>

<table summary="Rd table">
<tr>
 <td style="text-align: left;">
          <em>Matched pattern</em> </td><td style="text-align: left;"> <em>Function</em> </td><td style="text-align: left;"> <em>Used name</em>
          
          </td>
</tr>
<tr>
 <td style="text-align: left;"><code>ind</code> </td><td style="text-align: left;"> <code>*.*</code> </td><td style="text-align: left;"> <code>ind</code> </td><td style="text-align: left;">
          Index (positive <code>integer</code>) in internal value storage.
          </td>
</tr>
<tr>
 <td style="text-align: left;"><code>^c</code> </td><td style="text-align: left;"> <code>*.cr</code> </td><td style="text-align: left;"> <code>col</code> </td><td style="text-align: left;">
          Integer of non-zero length. Index of column/sample Length of column and row indices should be the same for creating set of two-dimension coordinates.</td>
</tr>
<tr>
 <td style="text-align: left;">
          </td>
</tr>
<tr>
 <td style="text-align: left;"><code>^r</code> </td><td style="text-align: left;"> <code>*.cr</code> </td><td style="text-align: left;"> <code>row</code> </td><td style="text-align: left;">
          Integer of non-zero length. Index of row/line. Length of column and row indices should be the same for creating set of two-dimension coordinates.
          </td>
</tr>
<tr>
 <td style="text-align: left;"><code>^x</code> </td><td style="text-align: left;"> <code>*.xy</code> </td><td style="text-align: left;"> <code>x</code> </td><td style="text-align: left;">
          Numeric of non-zero length. X-axis coordinate in grid of <code>obj</code>. The length of X-axis and Y-axis coordinates should be the same for creating set of two-dimension coordinates.
          </td>
</tr>
<tr>
 <td style="text-align: left;"><code>^y</code> </td><td style="text-align: left;"> <code>*.xy</code> </td><td style="text-align: left;"> <code>y</code> </td><td style="text-align: left;">
          Numeric of non-zero length. Y-axis coordinate in grid of <code>obj</code>. The length of X-axis and Y-axis coordinates should be the same for creating set of two-dimension coordinates.
          </td>
</tr>
<tr>
 <td style="text-align: left;"><code>^lon</code> </td><td style="text-align: left;"> <code>value.ll</code> </td><td style="text-align: left;"> <code>lon</code>  </td><td style="text-align: left;">
          Longitude. The length of longitudes and latitudes should be the same for creating set of two-dimension coordinates.
          </td>
</tr>
<tr>
 <td style="text-align: left;"><code>^lat</code> </td><td style="text-align: left;"> <code>value.ll</code> </td><td style="text-align: left;"> <code>lat</code> </td><td style="text-align: left;">
          Latitude. The length of longitudes and latitudes should be the same for creating set of two-dimension coordinates.
      </td>
</tr>

</table>

</td></tr>
</table>


<h3>Details</h3>

<p><code>value.xy</code> returns values for location, which is specified by planar coordinates (x, y).<br />
<code>value.cr</code> returns values for location, which is specified by cell posisition (column, row) relative to upper-left corner of image .<br />
<code>value.ll</code> returns values for location, which is specified by longitude and latitude (long, lat).
</p>
<p><code>coord.xy</code> transforms planar coordinates (x, y) to cell position (column, row).<br />
<code>coord.cr</code> transforms cell position (column, row) to planar coordinates (x, y).
</p>
<p>It is required to use a couple of coordinate vectors: <code>(x, y)</code>, <code>(c, r)</code> or <code>(lon, lat)</code> of the same length. The unary argument is interpreted as index in internal value storage.
</p>
<p>Position in column/row coordinates starts from upper-lever corner. The cell of upper-level corner has (1, 1) coordinates (in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> indices starts from <code>1L</code>), whereas in some GIS the same corner cell has (0, 0) coordinates.
</p>
<p>The column names of returned matrix are character format of index in internal value storage. This index can be specify in any function as argument <code>ind</code> instead of coordinates (planar, geographical, cell position).
</p>


<h3>Value</h3>

<p>For <code>value.*</code> numeric matrix of raster values. Band values for specific coordinates are by column. Set of specific coordinates are by row. <code><a href="../../base/html/colnames.html">rownames</a></code> are band names, and <code><a href="../../base/html/colnames.html">colnames</a></code> are index in internal value storage.
</p>
<p>For <code>coord.*</code> numeric matrix of coordinates with a vector of couple coordinates, one coordinate per one row. <code><a href="../../base/html/colnames.html">rownames</a></code> are returned coordinates, and <code><a href="../../base/html/colnames.html">colnames</a></code> are index in internal value storage.
</p>


<h3>Author(s)</h3>

<p>Nikita Platonov <a href="mailto:platonov@sevin.ru">platonov@sevin.ru</a>
</p>


<h3>Examples</h3>

<pre>
session.grid(NULL)
set.seed(352)
a &lt;- as.integer(rmap.dummy(3,min=0,max=999))
ind &lt;- which(rmap.value(a[1])==890)
print(ind)
msk &lt;- a[1]==890
am &lt;- a[msk]
b &lt;- as.data.frame(am)
b$jx &lt;- b$x+runif(nrow(b),min=-1000,max=1000)
b$jy &lt;- b$y+runif(nrow(b),min=-1000,max=1000)
print(b)
cr1 &lt;- coord.xy(a,x=b$jx,y=b$jy)
cr2 &lt;- coord.xy(a,y=b$y,x=b$x)
cr3 &lt;- coord.xy(a,ind=ind)
print(cr1)
print(all.equal(cr1,cr2,cr3))
xy1 &lt;- coord.cr(a,c=cr1["c",],r=cr1["r",])
print(xy1)
print(c(identical(unname(xy1["x",]),b[,"x",drop=TRUE])
       ,identical(unname(xy1["y",]),b[,"y",drop=TRUE])))
val1 &lt;- value.xy(a,x=b$jx,y=b$jy)
val2 &lt;- value.xy(a,x=b$x,y=b$y)
val3 &lt;- value.cr(a,ind=ind)
val4 &lt;- value.cr(a,c=cr1["c",],r=cr1["r",])
print(val1)
print(all.equal(val1,val2,val3,val4))
ps &lt;- pixelsize()
ll &lt;- c(lon=180,lat=70)
v &lt;- value.ll(ps,lon=180,lat=70)
print(c('True scale'=v/with(rmap.grid(ps),1e-6*resx*resy)))
</pre>


</body></html>
